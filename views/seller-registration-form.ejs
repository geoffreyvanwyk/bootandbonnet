<% layout('../../views/layout') -%>
<% script('../static/js/seller-registration-form.js') -%>

<%
var provincesString = JSON.stringify(provinces);
%>

<form id="register" method="post" action="<%=action%>">
	<input type="hidden" id="loggedIn" value="<%=isLoggedIn%>" />
    <h2><%=heading%></h2>
    <fieldset>
		<legend>Account credentials</legend>
		<div class="row">
			<div class="span6">
	<!-- Email address -->
				<div id="divEmail" class="control-group <%=validationErrors.emailAlertType%>">
					<label class="control-label" for="email">Email address</label>
					<div class="controls">
						<input type="email" id="email" name="user[emailAddress]" value="<%=user.emailAddress%>"/>
						<span id="spanEmail" class="help-inline"><%=validationErrors.emailError%></span>
					</div>
				</div>
			</div>
			<div class="span6">
	<!-- Password -->
				<div id="divPassword" class="control-group <%=validationErrors.passwordAlertType%>">
					<label class="control-label" for="password">Password</label>
					<div class="controls">
						<input type="password" id="password" name="user[password]" value="<%=user.password%>"/>
						<span id="spanPassword" class="help-inline"><%=validationErrors.passwordError%></span>
					</div>
				</div>
	<!-- Confirm password -->
				<div id="divConfirmPassword" class="control-group">
					<label class="control-label" for="confirmPassword">Confirm password</label>
					<div class="controls">
						<input type="password" id="confirmPassword" name="user[confirmPassword]"
							value="<%=user.password%>"/>
						<span id="spanConfirmPassword" class="help-inline"></span>
					</div>
				</div>
			</div>
		</div>
    </fieldset>
    <fieldset>
		<legend>Contact information</legend>
		<div class="row">
			<div class="span6">
	<!-- First name -->
				<div id="divFirstName" class="control-group <%=validationErrors.firstnameAlertType%>">
					<label class="control-label" for="first_name">First name</label>
					<div class="controls">
						<input type="text" id="first_name" name="seller[firstname]" 
							value="<%=seller.contactPerson.firstname%>"/>
						<span id="spanFirstName" class="help-inline"><%=validationErrors.firstnameError%></span>
					</div>
				</div>
	<!-- Surname -->
				<div id="divSurname" class="control-group <%=validationErrors.surnameAlertType%>">
					<label class="control-label"  for="surname">Surname</label>
					<div class="controls">
						<input type="text" id="surname" name="seller[surname]" 
							value="<%=seller.contactPerson.surname%>"/>
						<span id="spanSurname" class="help-inline"><%=validationErrors.surnameError%></span>
					</div>
				</div>
			</div>
			<div class="span6">
				<div id="contactNumbersAlert" class="alert alert-error"
						style="display: <%=validationErrors.contactNumbersAlertDisplay%>">
					<button type="button" class="close" data-dismiss="alert">&times;</button>
					Please supply either a telephone or a cellphone number, or both. Use only digits, e.g. 0123456789.
				</div>
	<!-- Telephone -->
				<div id="divTelephone" class="control-group">
					<label class="control-label" for="telephone">Telephone</label>
					<div class="controls">
						<input type="tel" id="telephone" name="seller[telephone]"
							value="<%=seller.contactNumbers[0]%>"/>
						<span id="spanTelephone" class="help-inline">&nbsp;</span>
					</div>
				</div>
	<!-- Cellphone -->
				<div id="divCellphone" class="control-group">
					<label class="control-label" for="cellphone">Cell phone</label>
					<div class="controls">
						<input type="tel" id="cellphone" name="seller[cellphone]"
							value="<%=seller.contactNumbers[1]%>"/>
						<span id="spanCellphone" class="help-inline">&nbsp;</span>
					</div>
				</div>
			</div>
		</div>
    </fieldset>
    <fieldset>
		<legend>Seller type</legend>
		<input type="hidden" id="sellerType" value="<%=sellerType%>" />
		<div id="sellerTypeAlert" class="alert alert-error" style="display: <%=sellerTypeAlertDisplay%>">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			Please specify which type of seller you are by clicking either the Private seller option button or the
			Dealership option button.
		</div>
		<div class="row">
	<!-- Private seller -->
			<div class="span3">
				<label class="radio">
					<input type="radio" id="privateSeller" name="seller[type]"
						value="private seller" checked="<%=privateRadioButton%>"/>Private seller
				</label>
			</div>
	<!-- Dealership -->
			<div class="span3">
				<label class="radio">
					<input type="radio" id="dealership"  name="seller[type]"
						value="dealership" checked="<%=dealerRadioButton%>"/>Dealership
				</label>
			</div>
		</div>
    </fieldset>
    <fieldset>
		<legend id="dealerOrLocation">Location</legend>
		<div id="locationAlert" class="alert alert-error" style="display: <%=locationAlertDisplay%>">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			Please specify the province and town.
		</div>
		<div class="row">
			<div class="span6" id="leftColumn">
				<div id="dealershipDetails" style="display: none">
	<!-- Dealership name -->
					<div class="control-group" >
						<label class="control-label" for="dealershipName">Name</label>
						<div class="controls">
							<input type="text" id="dealershipName" name="seller[dealershipName]"
								   value="<%=seller.dealershipName%>" />
							<span class="help-inline"></span>
						</div>
					</div>
	<!-- Street address -->
					<div class="control-group">
						<label class="control-label" for="street">Street address</label>
						<div class="controls">
							<input type="text" id="street" name="seller[street]"
								   value="<%=seller.address.street%>" /><br />
							<input type="text" id="suburb" name="seller[suburb]"
								   value="<%=seller.address.suburb%>" />
							<span class="help-inline"></span>
						</div>
					</div>
				</div>
	<!-- Province -->
				<div id="divProvinces" class="control-group <%=validationErrors.provinceAlertType%>">
					<label class="control-label" for="provinces">Province</label>
					<div class="controls">
						<select id="provinces" name="seller[province]">
						<% if (seller.address.province) { %>
							<option selected="selected" value="<%=seller.address.province%>">
								<%=seller.address.province%>
							</option>
						<% } else { %>
							<option selected="selected">Please select ...</option>
						<% } %>
						<% for (p in provinces) { %>
							<option value="<%=provinces[p].name%>"><%=provinces[p].name%></option>
						<% } %>
						</select>
						<span id="spanProvinces" class="help-inline"><%=validationErrors.provinceError%></span>
					</div>
				</div>
			</div>
			<div class="span6" id="rightColumn">
				<input type="hidden" id="locations" value="<%=provincesString%>" />
	<!-- Town -->
				<div id="divTowns" class="control-group <%=validationErrors.townAlertType%>">
					<label class="control-label" for="towns">Town</label>
					<div class="controls">
						<select id="towns" name="seller[town]">
						<% if (town) { %>
							<option selected="selected" value="<%=seller.address.town%>">
								<%=seller.address.town%>
							</option>
						<% } else { %>
							<option selected="selected">Please select ...</option>
						<% } %>
						</select>
						<span id="spanTowns" class="help-inline"><%=validationErrors.townError%></span>
					</div>
				</div>
			</div>
			</div>
    </fieldset>

    <div class="form-actions">
		<button type="submit" class="btn btn-primary" ><%=buttonCaption%></button>
		<button type="button" class="btn" id="cancelButton" >Cancel</button>
    </div>
</form>
