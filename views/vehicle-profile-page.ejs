<% layout('../views/layout') -%>

<%

var photo1 = vehicle.photos[0] ? "/vehicles/".concat(vehicle._id).concat("/photos/1") : "/static/img/image-placeholder.png";
var photo2 = vehicle.photos[1] ? "/vehicles/".concat(vehicle._id).concat("/photos/2") : "/static/img/image-placeholder.png";
var photo3 = vehicle.photos[2] ? "/vehicles/".concat(vehicle._id).concat("/photos/3") : "/static/img/image-placeholder.png";
var photo4 = vehicle.photos[3] ? "/vehicles/".concat(vehicle._id).concat("/photos/4") : "/static/img/image-placeholder.png";

if (vehicle.price.negotiable) {
var negotiable = 'negotiable';
} else {
var negotiable = 'not negotiable';
}

if (vehicle.description.fullServiceHistory) {
var fullServiceHistory = 'Yes';
var colorFullServiceHistory = 'green';
} else {
var fullServiceHistory = 'No';
var colorFullServiceHistory = 'red';
}

if (vehicle.mechanics.absBrakes) {
var absBrakes = 'Yes';
var colorAbsBrakes = 'green';
} else {
var absBrakes = 'No';
var colorAbsBrakes = 'red';
}

if (vehicle.security.alarm) {
var alarm = 'Yes';
var colorAlarm = 'green';
} else {
var alarm = 'No';
var colorAlarm = 'red';
}

if (vehicle.security.centralLocking) {
var centralLocking = 'Yes';
var colorCentralLocking = 'green';
} else {
var centralLocking = 'No';
var colorCentralLocking = 'red';
}

if (vehicle.security.immobilizer) {
var immobilizer = 'Yes';
var colorImmobilizer = 'green';
} else {
var immobilizer = 'No';
var colorImmobilizer = 'red';
}

if (vehicle.security.gearLock) {
var gearLock = 'Yes';
var colorGearLock = 'green';
} else {
var gearLock = 'No';
var colorGearLock = 'red';
}

if (vehicle.luxuries.airConditioning) {
var airConditioning = 'Yes';
var colorAirConditioning = 'green';
} else {
var airConditioning = 'No';
var colorAirConditioning = 'red';
}

if (vehicle.luxuries.cdPlayer) {
var cdPlayer = 'Yes';
var colorCDPlayer = 'green';
} else {
var cdPlayer = 'No';
var colorCDPlayer = 'red';
}

if (vehicle.luxuries.radio) {
var radio = 'Yes';
var colorRadio = 'green';
} else {
var radio = 'No';
var colorRadio = 'red';
}
%>

<div class="page-header">
	<h1>Vehicle <small><%=vehicle.market%></small></h1>
</div>

<h2>
	<%=vehicle.type.year%> <%=vehicle.type.make%> <%=vehicle.type.model%> R<%=vehicle.price.value%>
	<small><%=negotiable%></small>
</h2>

<div class="row">
	<div class="span6"> <!-- Thumbnails -->
		<ul class="thumbnails">
			<li class="span6">
				<img class="thumbnail" src="<%=photo1%>"/>
			</li>
			<li class="span2">
				<img class="thumbnail" src="<%=photo2%>"/>
			</li>
			<li class="span2">
				<img class="thumbnail" src="<%=photo3%>"/>
			</li>
			<li class="span2">
				<img class="thumbnail" src="<%=photo4%>"/>
			</li>
		</ul>
	</div>

	<div class="span6">
		<div class="row">
			<div class="span3"> <!-- Description -->
				<fieldset>
					<legend>Description</legend>

					<p>
						<strong>Mileage:</strong>
						<%=vehicle.description.mileage%> km
					</p>

					<p>
						<strong>Colour:</strong>
						<%=vehicle.description.color%>
					</p>

					<p>
						<strong>Full service history:</strong>
						<span style="color:<%=colorFullServiceHistory%>">
							<%=fullServiceHistory%>
						</span>
					</p>
				</fieldset>
			</div>

			<div class="span3"> <!-- Mechanics -->
				<fieldset>
					<legend>Mechanics</legend>

					<p>
						<strong>Engine capacity:</strong>
						<%=vehicle.mechanics.engineCapacity%> L
					</p>

					<p>
						<strong>Fuel type:</strong>
						<%=vehicle.mechanics.fuel%>
					</p>

					<p>
						<strong>Transmission:</strong>
						<%=vehicle.mechanics.transmission%>
					</p>

					<p>
						<strong>ABS Brakes:</strong>
						<span style="color:<%=colorAbsBrakes%>">
							<%=absBrakes%>
						</span>
					</p>
				</fieldset>
			</div>
		</div>

		<div class="row">
			<div class="span3"> <!-- Security -->
				<fieldset>
					<legend>Security</legend>

					<p>
						<strong>Alarm:</strong>
						<span style="color:<%=colorAlarm%>">
							<%=alarm%>
						</span>
					</p>

					<p>
						<strong>Central locking:</strong>
						<span style="color:<%=colorCentralLocking%>">
							<%=centralLocking%>
						</span>
					</p>

					<p>
						<strong>Immobiliser:</strong>
						<span style="color:<%=colorImmobilizer%>">
							<%=immobilizer%>
						</span>
					</p>

					<p>
						<strong>Gear lock:</strong>
						<span style="color:<%=colorGearLock%>">
							<%=gearLock%>
						</span>
					</p>
				</fieldset>
			</div>

			<div class="span3"> <!-- Luxuries -->
				<fieldset>
					<legend>Luxuries</legend>

					<p>
						<strong>Electrical windows:</strong>
						<%=vehicle.luxuries.electricWindows%>
					</p>

					<p>
						<strong>Air conditioning:</strong>
						<span style="color:<%=colorAirConditioning%>">
							<%=airConditioning%>
						</span>
					</p>

					<p>
						<strong>CD player:</strong>
						<span style="color:<%=colorCDPlayer%>">
							<%=cdPlayer%>
						</span>
					</p>

					<p>
						<strong>Radio:</strong>
						<span style="color:<%=colorRadio%>">
							<%=radio%>
						</span>
					</p>
				</fieldset>
			</div>
		</div>

		<div class="row">
			<div class="span3"> <!-- Safety -->
				<fieldset>
					<legend>Safety</legend>

					<p>
						<strong>Air bags:</strong>
						<%=vehicle.safety.airBags%>
					</p>
				</fieldset>
			</div>
		</div>

		<div class="row">
			<div class="span6"> <!-- Comments -->
				<fieldset>
					<legend>Comments from seller</legend>
					<p><%=vehicle.comments%></p>
				</fieldset>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="span6">
		<fieldset>
			<legend>Seller <small><%=seller.type%></small></legend>

			<div id="dealership" style="display: <%=dealerDisplay%>">
				<p><i class="icon-briefcase"></i>&nbsp;<strong><%=seller.dealershipName %></strong></p>
				<div class="row">
					<div class="span3">
						<p><i class="icon-road"></i>&nbsp;<%=seller.address.street%></p>
						<p><i class="icon-road"></i>&nbsp;<%=seller.address.suburb%></p>
						<p><i class="icon-map-marker"></i>&nbsp;<%=seller.address.town%></p>
						<p><i class="icon-map-marker"></i>&nbsp;<%=seller.address.province%></p>
					</div>
					<div class="span3">
						<p><i class="icon-user"></i>&nbsp;<%=seller.contactPerson.firstname%>&nbsp;<%=seller.contactPerson.surname%></p>
					<% for (var i = 0; i < seller.contactNumbers.length; i++) { %>
						<p><i class="icon-home"></i>&nbsp; <%=seller.contactNumbers[i]%></p>
					<% } %>
					</div>
				</div>
			</div>

			<div id="privateSeller" style="display: <%=privateSellerDisplay%>">
				<div class="row">
					<div class="span3">
						<p><i class="icon-user"></i>&nbsp;<%=seller.contactPerson.firstname%>&nbsp;<%=seller.contactPerson.surname%></p>
						<p>
							<i class="icon-map-marker"></i>&nbsp;
							<%=seller.address.town%>,
							<%=seller.address.province %>
						</p>
					</div>

					<div class="span3">
					<% for (var i = 0; i < seller.contactNumbers.length; i++) { %>
						<p><i class="icon-home"></i>&nbsp; <%=seller.contactNumbers[i]%></p>
					<% } %>
					</div>
				</div>
			</div>
		</fieldset>
	</div>

	<div class="span6">
		<form id="sendEmail" method="post" action="/vehicles/<%=vehicle._id%>/email-seller">
			<fieldset>
				<legend>Email seller</legend>

				<label>Your name:</label>
				<input type="text" id="buyerName" name="buyer[name]" />

				<label>Your email address:</label>
				<input type="email" id="buyerEmailAddress" name="buyer[emailAddress]" />

				<label>Message:</label>
				<textarea id="buyerMessage" name="buyer[message]" class="span6" />
				</textarea>

				<button class="btn btn-success">Send</button>
				<button class="btn">Clear</button>

				<input type="hidden" name="seller[emailAddress]" value="<%=user.emailAddress%>">
				<input type="hidden" name="vehicle[_id]" value="<%=vehicle._id%>">
			</fieldset>
		</form>
	</div>
</div>
<div class="form-actions" style="display:<%=formActionsDisplay%>">
	<a href="/vehicles/<%=vehicle._id%>/edit" class="btn btn-primary">Edit</a>
	<a href="/vehicles/<%=vehicle._id%>/remove" class="btn btn-danger">Delete</a>
</div>